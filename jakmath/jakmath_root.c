/*
 * jak_root.c
 *
 *  Created on: Jan 7, 2025
 *      Author: JAK
 */
#include "jakmath.h"
//
//static sint m0_root2(sint m0data)
//{
//	return 0;
//}
sint m0_root(sint m0data, sint root)
{
	return 0;
}
//
const word cw257groot2[257] =
{
	0, 1024, 1448, 1774, 2048, 2290, 2508, 2709, 2896, 3072, 3238, 3396, 3547, 3692, 3831, 3966, 4096, 4222, 4344, 4464, 4579,
	4693, 4803, 4911, 5017, 5120, 5221, 5321, 5418, 5514, 5609, 5701, 5793, 5882, 5971, 6058, 6144, 6229, 6312, 6395, 6476,
	6557, 6636, 6715, 6792, 6869, 6945, 7020, 7094, 7168, 7241, 7313, 7384, 7455, 7525, 7594, 7663, 7731, 7799, 7865, 7932,
	7998, 8063, 8128, 8192, 8256, 8319, 8382, 8444, 8506, 8567, 8628, 8689, 8749, 8809, 8868, 8927, 8986, 9044, 9102, 9159,
	9216, 9273, 9329, 9385, 9441, 9496, 9551, 9606, 9660, 9715, 9768, 9822, 9875, 9928, 9981, 10033, 10085, 10137, 10189, 10240,
	10291, 10342, 10392, 10443, 10493, 10543, 10592, 10642, 10691, 10740, 10789, 10837, 10885, 10933, 10981, 11029, 11076,
	11123, 11171, 11217, 11264, 11310, 11357, 11403, 11449, 11494, 11540, 11585, 11630, 11675, 11720, 11765, 11809, 11854,
	11898, 11942, 11986, 12029, 12073, 12116, 12159, 12202, 12245, 12288, 12331, 12373, 12415, 12457, 12500, 12541, 12583,
	12625, 12666, 12708, 12749, 12790, 12831, 12871, 12912, 12953, 12993, 13033, 13074, 13114, 13154, 13193, 13233, 13273,
	13312, 13351, 13391, 13430, 13469, 13507, 13546, 13585, 13623, 13662, 13700, 13738, 13777, 13815, 13852, 13890, 13928,
	13965, 14003, 14040, 14078, 14115, 14152, 14189, 14226, 14263, 14299, 14336, 14373, 14409, 14445, 14482, 14518, 14554,
	14590, 14626, 14661, 14697, 14733, 14768, 14804, 14839, 14874, 14910, 14945, 14980, 15015, 15050, 15084, 15119, 15154,
	15188, 15223, 15257, 15292, 15326, 15360, 15394, 15428, 15462, 15496, 15530, 15563, 15597, 15631, 15664, 15698, 15731,
	15764, 15798, 15831, 15864, 15897, 15930, 15963, 15995, 16028, 16061, 16093, 16126, 16158, 16191, 16223, 16255, 16288,
	16320, 16352, 16384, //
};
FASTFUNC static sint u0_root2(sint u0data)
{
	if (u0data > 0) return +cw257groot2[+u0data >> 12];
	if (u0data < 0) return -cw257groot2[-u0data >> 12];
	return 0;
}
FASTFUNC sint u0_root(sint u0data, sint root)
{
	if (u0data > +u0one) return 0;
	if (u0data < -u0one) return 0;
	//
	if (root == 2) return u0_root2(u0data);
	else return 0;
}
FASTFUNC sint g0_root2(sint g0data1)
{
	if (g0data1 > +g0one) return +g0one;
	if (g0data1 < -g0one) return -g0one;
	//
	return d0_look16(cw257groot2, g0data1 << 8, 257);
}
//
static union
{
	real f;
	uint i;
} conv;
static real f0x2;
real f0_root2(real f0data)
{
	f0x2 = f0data * 0.5F;
	conv.f = f0data;
	conv.i = 0x5f3759df - (conv.i >> 1);
	conv.f = conv.f * (1.5f - (f0x2 * conv.f * conv.f));
	return 1.0f / conv.f;
}
